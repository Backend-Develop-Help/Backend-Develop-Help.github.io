---
title: excel
date: 2024-04-27 16:19:46
author: ethandu
permalink: /pages/87a4d0/
---
# 代理费明细表

## 当月实际用电量

![image-20220804163424701](/img/ethandu/办公软件/excel.assets/image-20220804163424701.png)

> 函数细节介绍

- SUMIF函数是对选中范围内符合指定条件的值求和。

  sumif函数语法是：=SUMIF(range，criteria，sum_range)

  sumif函数的参数如下：

  第一个参数：Range为条件区域，用于条件判断的单元格区域。

  第二个参数：Criteria是求和条件，由数字、逻辑表达式等组成的判定条件。

  第三个参数：Sum_range 为实际求和区域，需要求和的单元格、区域或引用。

- ！在excel中可以起到引用的作用所以是引用符号

> 解释

```go
B:=结算单导入.getColumn("B")
for index,cell : range B{
    if cell.val == 当前sheet.valueOf("B3"){
        当前位置.值 += 结算导入.valueOf("G"+index)	
	}
}

return 当前位置.值
```

## 用户优惠电价

![image-20220804171425245](/img/ethandu/excel.assets/image-20220804171425245.png)

```go
B:=结算单导入.getColumn("B")
for index,cell : range B{
    if cell.val == 当前sheet.valueOf("B3"){
        当前位置.值 += 结算导入.valueOf("F"+index)	
	}
}

return 当前位置.值
```

## 代理基准价

![image-20220804171529226](/img/ethandu/excel.assets/image-20220804171529226.png)

> 函数细节介绍

- ROUND对数字进行四舍五入 小数点保留到第二个参数个位数
- L$2是对L列2行的混合引用

> 解释

```go
func SUMIF(...)...{...}

res := 466.78*SUMIF(套餐底表!A:A,B3,套餐底表!F:F)/100+L$2*SUMIF(套餐底表!A:A,B3,套餐底表!K:K)/100

return 	ROUND(res,3)
```



## 代理度电收益

```excel
=IF(D3-E3>1.066,D3-E3,IF(SUMIF(套餐底表!A:A,B3,套餐底表!U:U)-466.78>=-1,1/(1+H$1)*1.13,IF(SUMIF(套餐底表!A:A,B3,套餐底表!U:U)-466.78>=-2,0.6/(1+H$1)*1.13,IF(SUMIF(套餐底表!A:A,B3,套餐底表!U:U)-466.78>=-3,0.3/(1+H$1)*1.13,0))))
```



> 函数细节介绍

- IF函数是条件判断函数：如果指定条件的计算结果为 TRUE，IF函数将返回某个值；如果该条件的计算结果为 FALSE，则返回另一个值。

  语法：IF(logical_test,value_if_true,value_if_false)

  logical_test：测试条件

  value_if_true：满足条件返回的结果

  value_if_false：不满足条件返回的结果





```go
if D3-E3>1.066{
	return D3-E3
}else{
	if SUMIF(套餐底表!A:A,B3,套餐底表!U:U)-466.78>=-1
        return 1/(1+H$1)*1.13
	if SUMIF(套餐底表!A:A,B3,套餐底表!U:U)-466.78>=-2
    	return 0.6/(1+H$1)*1.13
    if SUMIF(套餐底表!A:A,B3,套餐底表!U:U)-466.78>=-3
    	return  0.3/(1+H$1)*1.13
	return 0
	}
}
```

## 全额计算金额（不含税）

````go
return ROUND(F3*C3/1.13,2)
````

## 代理分成比例

```excel
IF(G$1=1,80%,IF(G$1=2,84%,IF(G$1=3,88%,IF(G$1=4,92%,IF(G$1=5,96%,IF(G$1=6,100%,0))))))
```



> 解释

```go
if G$1=1
	return 80%
if G$1=2
	return 84%
if G$1=3
	return 88%
if G$1=4
	return 92%
if G$1=5
	return 96%
return 0
```

## 当月结算（不含税）

```go
return ROUND(G3*H3,2)
```

